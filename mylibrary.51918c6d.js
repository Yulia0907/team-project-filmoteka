function e(e,t,a,o){Object.defineProperty(e,t,{get:a,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},n={},r=a.parcelRequire6149;null==r&&((r=function(e){if(e in o)return o[e].exports;if(e in n){var t=n[e];delete n[e];var a={id:e,exports:{}};return o[e]=a,t.call(a.exports,a,a.exports),a.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){n[e]=t},a.parcelRequire6149=r),r.register("kyEFX",(function(t,a){var o,n;e(t.exports,"register",(function(){return o}),(function(e){return o=e})),e(t.exports,"resolve",(function(){return n}),(function(e){return n=e}));var r={};o=function(e){for(var t=Object.keys(e),a=0;a<t.length;a++)r[t[a]]=e[t[a]]},n=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r("kyEFX").register(JSON.parse('{"6EVkV":"mylibrary.51918c6d.js","hZOQc":"thereNothingHere.d5e2b699.jpg","5UbS1":"index.253d2dff.css","5fZck":"index.894a8c23.js"}'));var i=r("2ySY5"),l=r("dARph"),s=r("kLGAr");r("fb9GJ");var c;c=new URL(r("kyEFX").resolve("hZOQc"),import.meta.url).toString();var d=r("25RCP"),u=r("fQ3Fn"),g=r("amyG6");const m=`<li class="default-img"><img src="${t(c)}" \n  alt="nothing-here" width="400px"></img></li>`,h=(0,d.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),f=((0,u.getDatabase)(h),(0,u.ref)((0,u.getDatabase)())),v=(0,g.getAuth)();let p,b,L=[],S=[],y="";const w=document.querySelector(".logout"),k=document.querySelector(".welcome-ml");(0,g.onAuthStateChanged)(v,(e=>{e?(p=e.uid,b=e.email,console.log("Это обсервер my-library"),w.classList.remove("visually-hidden"),k.innerHTML=`Welcome, ${b}!`):w.classList.add("visually-hidden")}));const E=document.querySelector(".movies"),H=document.querySelector('[data-id="watched-btn"'),M=document.querySelector('[data-id="queue-btn"'),q=(document.querySelector(".header-nav__link--current-header"),new(0,s.localStorageAPI));function I(e){const t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{const e=q.getData("watched"),a=q.getData("genresList"),o=e.filter((({id:e})=>e===Number(t)))[0],{genre_ids:n}=o;let r;n&&(r=a.filter((({id:e})=>n.includes(e))).map((({name:e})=>e))),o.genres=r,q.setData("current-film",o),(0,l.modalBasicLightbox)(o,"watched"),q.addListenersToBtns()}catch(e){console.log(e.message)}}function A(e){const t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{const e=q.getData("queue"),a=q.getData("genresList"),o=e.filter((({id:e})=>e===Number(t)))[0],{genre_ids:n}=o;let r;n&&(r=a.filter((({id:e})=>n.includes(e))).map((({name:e})=>e))),o.genres=r,q.setData("current-film",o),(0,l.modalBasicLightbox)(o,"queue"),q.addListenersToBtns()}catch(e){console.log(e.message)}}H.addEventListener("click",(function(){if(E.removeEventListener("click",A),H.classList.contains("is-active"))return;(0,g.onAuthStateChanged)(v,(e=>{e?(p=e.uid,b=e.email,(0,u.get)((0,u.child)(f,`users/${p}watched/watched`)).then((e=>{e.exists()?(L=e.val(),console.log("getWatched",e.val()),y=(0,i.createMovieCards)(L),E.innerHTML=y,E.addEventListener("click",I)):(console.log("No data available"),L=e.val(),console.log("getWatched",e.val()),y=m,E.innerHTML=y,E.addEventListener("click",I))})).catch((e=>{console.error(e)}))):(L=q.getData("watched"),y=null===L||0===L.length?m:(0,i.createMovieCards)(L),E.innerHTML=y,E.addEventListener("click",I))}))})),M.addEventListener("click",(function(){if(E.removeEventListener("click",I),!H.classList.contains("is-active"))return;(0,g.onAuthStateChanged)(v,(e=>{if(e)p=e.uid,b=e.email,(0,u.get)((0,u.child)(f,`users/${p}queue/queue`)).then((e=>{e.exists()?(S=e.val(),console.log("getQueue",e.val()),y=(0,i.createMovieCards)(S),E.innerHTML=y,E.addEventListener("click",A)):(console.log("No data available"),L=e.val(),console.log("getWatched",e.val()),y=m,E.innerHTML=y,E.addEventListener("click",I))})).catch((e=>{console.error(e)}));else{const e=q.getData("queue");y=null===e||0===e.length?m:(0,i.createMovieCards)(e),E.innerHTML=y,E.addEventListener("click",A)}}))})),function(){let e=[];(0,g.onAuthStateChanged)(v,(t=>{t?(p=t.uid,b=t.email,(0,u.get)((0,u.child)(f,`users/${p}watched/watched`)).then((t=>{t.exists()?(e=t.val(),localStorage.setItem("watched",JSON.stringify(e)),console.log("getWatched",t.val()),y=(0,i.createMovieCards)(e),E.innerHTML=y,E.addEventListener("click",I)):(console.log("No data available"),e=t.val(),console.log("getWatched",t.val()),y=m,E.innerHTML=y,E.addEventListener("click",I))})).catch((e=>{console.error(e)})),(0,u.get)((0,u.child)(f,`users/${p}queue/queue`)).then((t=>{t.exists()?(S=t.val(),localStorage.setItem("queue",JSON.stringify(S)),console.log("getQueue",t.val()),y=(0,i.createMovieCards)(S)):(console.log("No data available"),e=t.val())})).catch((e=>{console.error(e)}))):(e=q.getData("watched"),y=null===e||0===e.length?m:(0,i.createMovieCards)(e),E.innerHTML=y,E.addEventListener("click",I))}))}(),r("1VOaQ"),r("ioBS9"),r("6pjkE"),r("04jNI"),r("82jod");d=r("25RCP"),u=r("fQ3Fn"),g=r("amyG6");var T=r("6pjkE");const j=(0,d.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),N=((0,u.getDatabase)(j),(0,g.getAuth)()),x=document.querySelector(".logout"),C=document.querySelector(".welcome-ml");let D,F;console.log("firebase-ml is running");document.querySelector(".welcome-ml");const _=document.querySelector(".login");(0,g.onAuthStateChanged)(N,(e=>{e?(D=e.uid,F=e.email,console.log("current user = ",F),x.classList.remove("visually-hidden"),_.classList.add("visually-hidden"),C.innerHTML=`Welcome, ${F}!`):_.classList.remove("visually-hidden")})),T.registrationFormSubmit.addEventListener("click",(function(e){e.preventDefault();const t=T.registrationFormEmail.value;console.log(t);const a=T.registrationFormPassword.value;console.log(a),(0,g.createUserWithEmailAndPassword)(N,t,a).then((e=>{e.user})).catch((e=>{const t=e.code,a=e.message;console.log(t),console.log(a)})),T.registrationForm.reset(),(0,T.closeOnSubmit)()})),T.loginForm.addEventListener("submit",(function(e){e.preventDefault(),localStorage.removeItem("watched"),localStorage.removeItem("queue");const t=T.loginFormEmail.value,a=T.loginFormPassword.value;(0,g.signInWithEmailAndPassword)(N,t,a).then((e=>{e.user;window.location.reload()})).catch((e=>{e.code,e.message})),T.loginForm.reset(),(0,T.closeOnSubmit)()})),x.addEventListener("click",(function(){(0,g.signOut)(N).then((()=>{F=null,window.location.reload()})).catch((e=>{console.log(e)}))}));
//# sourceMappingURL=mylibrary.51918c6d.js.map
