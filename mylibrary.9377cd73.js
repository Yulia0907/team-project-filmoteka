!function(){function e(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},o={},r=n.parcelRequire6149;null==r&&((r=function(e){if(e in a)return a[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return a[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},n.parcelRequire6149=r),r.register("iE7OH",(function(t,n){var a,o;e(t.exports,"register",(function(){return a}),(function(e){return a=e})),e(t.exports,"resolve",(function(){return o}),(function(e){return o=e}));var r={};a=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)r[t[n]]=e[t[n]]},o=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r.register("aNJCr",(function(t,n){var a;e(t.exports,"getBundleURL",(function(){return a}),(function(e){return a=e}));var o={};function r(e){return(""+e).replace(/^((?:https?|file|ftp|(chrome|moz)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}a=function(e){var t=o[e];return t||(t=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz)-extension):\/\/[^)\n]+/g);if(e)return r(e[2])}return"/"}(),o[e]=t),t}})),r("iE7OH").register(JSON.parse('{"2bI8P":"mylibrary.9377cd73.js","jxU4Y":"thereNothingHere.d5e2b699.jpg","5UbS1":"index.253d2dff.css","5ZwWc":"index.f5f8241a.js"}'));var i=r("aTzrc"),c=r("g2YN6"),l=r("6fJbC");r("1VFfL");var s;s=r("aNJCr").getBundleURL("2bI8P")+r("iE7OH").resolve("jxU4Y");var u,d,g=r("6Urw1"),f=r("6Nu6u"),m=r("3SEMc"),v='<li class="default-img"><img src="'.concat(t(s),'" \n  alt="nothing-here" width="400px"></img></li>'),h=(0,g.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),p=((0,f.getDatabase)(h),(0,f.ref)((0,f.getDatabase)())),b=(0,m.getAuth)(),L=[],w=[],S="",y=document.querySelector(".logout"),E=document.querySelector(".welcome-ml");(0,m.onAuthStateChanged)(b,(function(e){e?(u=e.uid,d=e.email,console.log("Это обсервер my-library"),y.classList.remove("visually-hidden"),E.innerHTML="Welcome, ".concat(d,"!")):y.classList.add("visually-hidden")}));var k,H=document.querySelector(".movies"),M=document.querySelector('[data-id="watched-btn"'),x=document.querySelector('[data-id="queue-btn"'),N=(document.querySelector(".header-nav__link--current-header"),new(0,l.localStorageAPI));function q(e){var t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{var n,a=N.getData("watched"),o=N.getData("genresList"),r=a.filter((function(e){return e.id===Number(t)}))[0],i=r.genre_ids;i&&(n=o.filter((function(e){var t=e.id;return i.includes(t)})).map((function(e){return e.name}))),r.genres=n,N.setData("current-film",r),(0,c.modalBasicLightbox)(r,"watched"),N.addListenersToBtns()}catch(e){console.log(e.message)}}function I(e){var t=e.target.closest("li").dataset.id;if("UL"!==e.target.nodeName)try{var n,a=N.getData("queue"),o=N.getData("genresList"),r=a.filter((function(e){return e.id===Number(t)}))[0],i=r.genre_ids;i&&(n=o.filter((function(e){var t=e.id;return i.includes(t)})).map((function(e){return e.name}))),r.genres=n,N.setData("current-film",r),(0,c.modalBasicLightbox)(r,"queue"),N.addListenersToBtns()}catch(e){console.log(e.message)}}M.addEventListener("click",(function(){if(H.removeEventListener("click",I),M.classList.contains("is-active"))return;(0,m.onAuthStateChanged)(b,(function(e){e?(u=e.uid,d=e.email,(0,f.get)((0,f.child)(p,"users/".concat(u,"watched/watched"))).then((function(e){e.exists()?(L=e.val(),console.log("getWatched",e.val()),S=(0,i.createMovieCards)(L),H.innerHTML=S,H.addEventListener("click",q)):(console.log("No data available"),L=e.val(),console.log("getWatched",e.val()),S=v,H.innerHTML=S,H.addEventListener("click",q))})).catch((function(e){console.error(e)}))):(L=N.getData("watched"),S=null===L||0===L.length?v:(0,i.createMovieCards)(L),H.innerHTML=S,H.addEventListener("click",q))}))})),x.addEventListener("click",(function(){if(H.removeEventListener("click",q),!M.classList.contains("is-active"))return;(0,m.onAuthStateChanged)(b,(function(e){if(e)u=e.uid,d=e.email,(0,f.get)((0,f.child)(p,"users/".concat(u,"queue/queue"))).then((function(e){e.exists()?(w=e.val(),console.log("getQueue",e.val()),S=(0,i.createMovieCards)(w),H.innerHTML=S,H.addEventListener("click",I)):(console.log("No data available"),L=e.val(),console.log("getWatched",e.val()),S=v,H.innerHTML=S,H.addEventListener("click",q))})).catch((function(e){console.error(e)}));else{var t=N.getData("queue");S=null===t||0===t.length?v:(0,i.createMovieCards)(t),H.innerHTML=S,H.addEventListener("click",I)}}))})),k=[],(0,m.onAuthStateChanged)(b,(function(e){e?(u=e.uid,d=e.email,(0,f.get)((0,f.child)(p,"users/".concat(u,"watched/watched"))).then((function(e){e.exists()?(k=e.val(),localStorage.setItem("watched",JSON.stringify(k)),console.log("getWatched",e.val()),S=(0,i.createMovieCards)(k),H.innerHTML=S,H.addEventListener("click",q)):(console.log("No data available"),k=e.val(),console.log("getWatched",e.val()),S=v,H.innerHTML=S,H.addEventListener("click",q))})).catch((function(e){console.error(e)})),(0,f.get)((0,f.child)(p,"users/".concat(u,"queue/queue"))).then((function(e){e.exists()?(w=e.val(),localStorage.setItem("queue",JSON.stringify(w)),console.log("getQueue",e.val()),S=(0,i.createMovieCards)(w)):(console.log("No data available"),k=e.val())})).catch((function(e){console.error(e)}))):(k=N.getData("watched"),S=null===k||0===k.length?v:(0,i.createMovieCards)(k),H.innerHTML=S,H.addEventListener("click",q))})),r("dsadE"),r("4smAb"),r("8uW00"),r("j1lrD"),r("4Hwvb");g=r("6Urw1"),f=r("6Nu6u"),m=r("3SEMc");var T,A=r("8uW00"),C=(0,g.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),D=((0,f.getDatabase)(C),(0,m.getAuth)()),j=document.querySelector(".logout"),_=document.querySelector(".welcome-ml");console.log("firebase-ml is running");document.querySelector(".welcome-ml");var W=document.querySelector(".login");(0,m.onAuthStateChanged)(D,(function(e){e?(e.uid,T=e.email,console.log("current user = ",T),j.classList.remove("visually-hidden"),W.classList.add("visually-hidden"),_.innerHTML="Welcome, ".concat(T,"!")):W.classList.remove("visually-hidden")})),A.registrationFormSubmit.addEventListener("click",(function(e){e.preventDefault();var t=A.registrationFormEmail.value;console.log(t);var n=A.registrationFormPassword.value;console.log(n),(0,m.createUserWithEmailAndPassword)(D,t,n).then((function(e){e.user})).catch((function(e){var t=e.code,n=e.message;console.log(t),console.log(n)})),A.registrationForm.reset(),(0,A.closeOnSubmit)()})),A.loginForm.addEventListener("submit",(function(e){e.preventDefault(),localStorage.removeItem("watched"),localStorage.removeItem("queue");var t=A.loginFormEmail.value,n=A.loginFormPassword.value;(0,m.signInWithEmailAndPassword)(D,t,n).then((function(e){e.user;window.location.reload()})).catch((function(e){e.code,e.message})),A.loginForm.reset(),(0,A.closeOnSubmit)()})),j.addEventListener("click",(function(){(0,m.signOut)(D).then((function(){T=null,window.location.reload()})).catch((function(e){console.log(e)}))}))}();
//# sourceMappingURL=mylibrary.9377cd73.js.map
