function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},r=t.parcelRequire6149;null==r&&((r=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var r={id:e,exports:{}};return n[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},t.parcelRequire6149=r);var i,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt,d="object"==typeof t&&t&&t.Object===Object&&t,f="object"==typeof self&&self&&self.Object===Object&&self,m=d||f||Function("return this")(),v=Object.prototype.toString,g=Math.max,p=Math.min,h=function(){return m.Date.now()};function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==v.call(e)}(e))return NaN;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=c.test(e);return n||l.test(e)?u(e.slice(2),n?2:8):s.test(e)?NaN:+e}i=function(e,t,n){var o,r,i,a,s,c,l=0,u=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var n=o,i=r;return o=r=void 0,l=t,a=e.apply(i,n)}function v(e){return l=e,s=setTimeout(L,t),u?m(e):a}function w(e){var n=e-c;return void 0===c||n>=t||n<0||d&&e-l>=i}function L(){var e=h();if(w(e))return S(e);s=setTimeout(L,function(e){var n=t-(e-c);return d?p(n,i-(e-l)):n}(e))}function S(e){return s=void 0,f&&o?m(e):(o=r=void 0,a)}function _(){var e=h(),n=w(e);if(o=arguments,r=this,c=e,n){if(void 0===s)return v(c);if(d)return s=setTimeout(L,t),m(c)}return void 0===s&&(s=setTimeout(L,t)),a}return t=b(t)||0,y(n)&&(u=!!n.leading,i=(d="maxWait"in n)?g(b(n.maxWait)||0,t):i,f="trailing"in n?!!n.trailing:f),_.cancel=function(){void 0!==s&&clearTimeout(s),l=0,o=c=r=s=void 0},_.flush=function(){return void 0===s?a:S(h())},_};var w=r("cqGDw");function L(e){const t=S(e);return _(t)}const S=e=>e.map((e=>{let{title:t="",vote_average:n="",release_date:o="",id:r=""}=e;return o.length>0&&(o=o.slice(0,4)),{title:t,vote_average:n,release_date:o,id:r}})),_=e=>e.map(M).join(""),M=({title:e,release_date:t,id:n},o,r)=>`\n      <div class="search-result__item " tadindex="0" data-index=${o} data-id=${n}>\n        <p class="search-result__title">${e}</p>\n        <span class="search-result__date"> (${t})</span>\n      </div>\n      `;w=r("cqGDw");var T=r("2ySY5");function E(e,t=0){return{totalItems:e,itemsPerPage:20,visiblePages:3,centerAlign:!0,firstItemClassName:"pagination-first-child",lastItemClassName:"pagination-last-child",usageStatistics:!0}}var j=r("dARph"),k=r("kLGAr"),I=r("fb9GJ");r("ffjl9");const N=document.querySelector(".movies"),q=document.querySelector(".hero-home__form"),x=document.querySelector(".fail-search"),O=new(0,k.localStorageAPI);async function D(e){A(await(0,w.fetchMoviesByName)(e),e)}async function C(e){const t=await(0,w.fetchMovieById)(e),n={};n.results=[{...t}],n.total_results=1,localStorage.setItem("movies",JSON.stringify(n.results)),A(n)}function A(t,n){if(0===t.results.length)return x.classList.remove("is-hidden"),setTimeout((()=>x.classList.add("is-hidden")),5e3),void q.reset();N.innerHTML=(0,T.createMovieCards)(t.results);new(e(I))("pagination",E(t.total_results)).on("afterMove",(({page:e})=>{(0,w.fetchMoviesByName)(n,e).then((e=>{N.innerHTML=(0,T.createMovieCards)(e.results),window.scrollTo({top:0,behavior:"smooth"})})).catch((e=>{console.log(e)}))}))}N.addEventListener("click",(async function(e){const t=e.target.closest("li").dataset.id;if("UL"===e.target.nodeName)return;const n=O.getData("movies"),o=O.getData("genresList"),r=n.filter((({id:e})=>e===Number(t)))[0],{genre_ids:i}=r;let a;i&&(a=o.filter((({id:e})=>i.includes(e))).map((({name:e})=>e)));r.genres=a,O.setData("current-film",r),(0,j.modalBasicLightbox)(r,"movies"),O.addListenersToBtns()}));const F=document.querySelector(".search-result"),H=document.querySelector(".hero-home__form"),B=document.querySelector(".form_input");let P=[],$="",G=0,W="";let J=0;async function Q(e){const t=G+4;for(;t>G&&J>G;){const t=await(0,w.fetchMoviesByNameQuickSearch)(e,G+=1);G=t.page,P=0===P.length?[...t.results]:[...P,...t.results]}return P}async function R(e){e=e.toLowerCase();let t=[],n=!1;if(W!=e)n=!0,t=await async function(e){P=[],G=0;const t=await(0,w.fetchMoviesByNameQuickSearch)(e,G+=1);return W=e,P=[...t.results],J=t.total_pages,G=t.page,Q(e)}(e);else{if(G===J)return;t=await Q(e)}const o=L(t);return n?U(o):z(o),P=[],"ok"}const U=e=>{F.innerHTML=e,document.body.addEventListener("click",K)},z=e=>{F.insertAdjacentHTML("beforeend",e),document.body.removeEventListener("click",K),document.body.addEventListener("click",K)},K=e=>{e.target.closest(".hero-home__form")||(Y(),document.body.removeEventListener("click",K)),console.log("evt:  ",e);let t=e.target.closest(".search-result__item");const n=t.dataset.id;t.firstElementChild.textContent;Y(),C(n)};H.addEventListener("submit",(function(e){e.preventDefault();const t=H.elements.searchQuery.value.trim();return""===t?console.log("Empty search query"):(Y(),void D(t))}));const Y=()=>{U("")};B.addEventListener("input",e(i)((async function(e){if($=e.target.value.trim(),0===$.length)return Y(),void(G=0);G=0,P=[],await R($)}),500)),F.addEventListener("scroll",e(i)((e=>{const{offsetHeight:t,scrollHeight:n,scrollTop:o}=e.target;if(.3*n>n-t-o)return P=[],void R($)}),100)),r("6pjkE");var V=r("25RCP"),X=r("fQ3Fn"),Z=r("amyG6"),ee=r("6pjkE");const te=(0,V.initializeApp)({apiKey:"AIzaSyCI5JTbKtHIHNuS4WcbgMfz2S8WxJp_ehM",authDomain:"filmoteka-proj-7.firebaseapp.com",databaseURL:"https://filmoteka-proj-7-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"filmoteka-proj-7",storageBucket:"filmoteka-proj-7.appspot.com",messagingSenderId:"181528100082",appId:"1:181528100082:web:031dd9add36023a4e5e46b",measurementId:"G-1X27T2N03L"}),ne=((0,X.getDatabase)(te),(0,Z.getAuth)()),oe=document.querySelector(".logout");let re,ie;const ae=document.querySelector(".welcome"),se=document.querySelector(".login");(0,Z.onAuthStateChanged)(ne,(e=>{e&&(re=e.uid,ie=e.email,oe.classList.remove("visually-hidden"),se.classList.add("visually-hidden"),console.log("current user = ",ie),ae.innerHTML=`Welcome, ${ie}!`)})),ee.registrationFormSubmit.addEventListener("click",(function(e){e.preventDefault();const t=ee.registrationFormEmail.value;console.log(t);const n=ee.registrationFormPassword.value;console.log(n),(0,Z.createUserWithEmailAndPassword)(ne,t,n).then((e=>{e.user})).catch((e=>{const t=e.code,n=e.message;console.log(t),console.log(n)})),ee.registrationForm.reset(),(0,ee.closeOnSubmit)()})),ee.loginForm.addEventListener("submit",(function(e){e.preventDefault(),localStorage.removeItem("watched"),localStorage.removeItem("queue");const t=ee.loginFormEmail.value,n=ee.loginFormPassword.value;(0,Z.signInWithEmailAndPassword)(ne,t,n).then((e=>{e.user;window.location.reload()})).catch((e=>{e.code,e.message})),ee.loginForm.reset(),(0,ee.closeOnSubmit)()})),oe.addEventListener("click",(function(){(0,Z.signOut)(ne).then((()=>{ie=null,oe.classList.add("visually-hidden"),se.classList.remove("visually-hidden"),localStorage.clear()})).catch((e=>{})),window.location.reload()}));w=r("cqGDw"),T=r("2ySY5"),I=r("fb9GJ");const ce=document.querySelector(".movies");!async function(){const t=await(0,w.fetchTrendingMovies)();ce.innerHTML=(0,T.createMovieCards)(t.results),console.log("res: ",t),new(e(I))("pagination",E(t.total_results)).on("afterMove",(({page:e})=>{(0,w.fetchTrendingMovies)(e).then((e=>{ce.innerHTML=(0,T.createMovieCards)(e.results),window.scrollTo({top:0,behavior:"smooth"})}))}))}(),r("ioBS9"),r("04jNI"),r("82jod"),r("1VOaQ");
//# sourceMappingURL=index.daa3e36f.js.map
